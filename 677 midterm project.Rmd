---
title: "MA 677 Midterm Project"
output:
  html_document: default
  pdf_document: default
date: "2024-03-29"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Order statistics - Required
# Uniform Distribution:
For a uniform distribution U(0, 1), the probability density function (pdf) of the i-th order statistic X_(i) is given by the beta distribution with parameters alpha = i and beta = n - i + 1.

# Exponential Distribution:
For an exponential distribution with rate λ, the pdf of the i-th order statistic X_(i) is more complex and involves the Gamma function. However, the minimum value (first order statistic) from an exponential distribution is again an exponential distribution with the same rate λ.

# Normal Distribution:
For a normal distribution, order statistics do not have closed-form expressions for their distributions.However, their expected values can be approximated using the quantiles of the standard normal distribution.

```{r}
# Define the number of simulations and sample size
n_sim <- 10000
n <- 100

# Uniform distribution simulation
uniform_samples <- matrix(runif(n * n_sim), ncol = n)
uniform_order_stats <- apply(uniform_samples, 1, sort)

# Exponential distribution simulation
lambda <- 1  # Rate parameter
exponential_samples <- matrix(rexp(n * n_sim, rate = lambda), ncol = n)
exponential_order_stats <- apply(exponential_samples, 1, sort)

# Normal distribution simulation
normal_samples <- matrix(rnorm(n * n_sim), ncol = n)
normal_order_stats <- apply(normal_samples, 1, sort)

# Calculate the means of the minimum, 25th, 50th, 75th percentile, and maximum
uniform_results <- colMeans(matrix(uniform_order_stats[,c(1, n/4, n/2, 3*n/4, n)], ncol = 5))
exponential_results <- colMeans(matrix(exponential_order_stats[,c(1, n/4, n/2, 3*n/4, n)], ncol = 5))
normal_results <- colMeans(matrix(normal_order_stats[,c(1, n/4, n/2, 3*n/4, n)], ncol = 5))

# Print the results
print('Uniform distribution order statistics:')
print(uniform_results)
print('Exponential distribution order statistics:')
print(exponential_results)
print('Normal distribution order statistics:')
print(normal_results)

```
```{r}


# Load required libraries
library(ggplot2)

# Create data frames for plotting
uniform_data <- data.frame(value = c(uniform_order_stats[,1], uniform_order_stats[,n/4],
                                     uniform_order_stats[,n/2], uniform_order_stats[,3*n/4],
                                     uniform_order_stats[,n]),
                           order_stat = rep(c('Min', '25th', 'Median', '75th', 'Max'), each = n_sim))

exponential_data <- data.frame(value = c(exponential_order_stats[,1], exponential_order_stats[,n/4],
                                         exponential_order_stats[,n/2], exponential_order_stats[,3*n/4],
                                         exponential_order_stats[,n]),
                               order_stat = rep(c('Min', '25th', 'Median', '75th', 'Max'), each = n_sim))

normal_data <- data.frame(value = c(normal_order_stats[,1], normal_order_stats[,n/4],
                                    normal_order_stats[,n/2], normal_order_stats[,3*n/4],
                                    normal_order_stats[,n]),
                          order_stat = rep(c('Min', '25th', 'Median', '75th', 'Max'), each = n_sim))

# Plot for Uniform distribution
ggplot(uniform_data, aes(x=value, fill=order_stat)) +
  geom_histogram(bins=30, alpha=0.6) +
  facet_wrap(~order_stat, scales='free') +
  labs(title='Uniform Distribution Order Statistics', x='Value', y='Frequency') +
  theme_minimal()

# Plot for Exponential distribution
ggplot(exponential_data, aes(x=value, fill=order_stat)) +
  geom_histogram(bins=30, alpha=0.6) +
  facet_wrap(~order_stat, scales='free') +
  labs(title='Exponential Distribution Order Statistics', x='Value', y='Frequency') +
  theme_minimal()

# Plot for Normal distribution
ggplot(normal_data, aes(x=value, fill=order_stat)) +
  geom_histogram(bins=30, alpha=0.6) +
  facet_wrap(~order_stat, scales='free') +
  labs(title='Normal Distribution Order Statistics', x='Value', y='Frequency') +
  theme_minimal()

```

The histograms show the distributions of the order statistics for three different distributions: uniform, exponential, and normal. Each histogram corresponds to a different order statistic, from the minimum (Min) to the 25th, 50th (Median), 75th percentiles, and the maximum (Max).

For the uniform distribution, the histograms display the characteristics of a Beta distribution, which is the theoretical distribution of order statistics from a uniform distribution. The Min and Max are skewed towards the ends of the range [0,1], as expected, while the median is centered around 0.5. The 25th and 75th percentiles are near 0.25 and 0.75, respectively, but they have wider spreads because they are less extreme than the Min and Max.

For the exponential distribution, we see that the Min is heavily skewed towards 0, which aligns with the expectation that the minimum value from an exponential distribution should be an exponential distribution itself. The other statistics spread out more as we move from Min to Max, reflecting the memoryless property of the exponential distribution.

For the normal distribution, the histograms of the order statistics appear symmetric around the mean, which is expected for normal distributions. The spread of the histograms increases as we move from the Min to the Max, which is consistent with the increasing variance of the order statistics.

These plots give a visual confirmation of our theoretical expectations for the distribution of order statistics. For the uniform distribution, this exercise illustrates the convergence to Beta distributions for the order statistics. The exponential and normal plots illustrate the spreading effect of order statistics as we move from Min to Max, showing a broader spread for higher order statistics.

## Markov chains

# Application

Markov chains provide a mathematical framework for modeling systems that transition from one state to another in a chain-like fashion. In manufacturing, this concept is particularly useful for modeling the state of machines over time, production processes, or supply chain logistics.

# Markov chain

A Markov chain consists of various states and the probabilities of transitioning from one state to another. These probabilities are known as transition probabilities and are typically expressed in a matrix form.The key property of a Markov chain is that the probability of moving to the next state depends only on the current state and not on how the system arrived in that state (this is known as the Markov property).

# Manufacturing Application

Imagine a machine that can be in one of three states: Operating (O), Idle (I), or Under Maintenance (M). The machine transitions between these states from day to day.
For example, if the machine is Operating on a given day, there might be a 90% chance it will be Operating the next day, a 5% chance it will go Idle, and a 5% chance it will require Maintenance.
The transition matrix would look something like this (rows are current states, columns are next states):
```{r}
# Define the transition matrix
P <- matrix(c(0.9, 0.05, 0.05,
              0.1, 0.8, 0.1,
              0.0, 0.0, 1.0), nrow = 3, byrow = TRUE)

# Define the initial state (assuming the machine starts in the Operating state)
state <- c(1, 0, 0)  # The machine is in the 'Operating' state at the start

# Define the number of days to simulate
n_days <- 10

# Simulation of Markov chain over n days
for (i in 1:n_days) {
  state <- as.numeric(state %*% P)
  cat(sprintf("Day %d: Operating = %.2f, Idle = %.2f, Maintenance = %.2f\n", 
              i, state[1], state[2], state[3]))
}

```
Day 1: We start with the machine in the Operating state with a high probability (0.90). There's a small chance that the machine will either be Idle or need Maintenance the next day (each with a probability of 0.05).

Day 2: The probability of the machine continuing to operate drops slightly to 0.82, reflecting the cumulative risk of the machine going Idle or needing Maintenance as per the transition probabilities. Correspondingly, the probabilities of being Idle or in Maintenance have increased slightly to 0.09 and 0.10, respectively.

Subsequent Days: With each passing day, the model predicts a steady decrease in the probability of the machine operating and a gradual increase in the probability of it being Idle or in Maintenance. This trend continues due to the nature of the transition probabilities, which suggest that over time, the machine is more likely to move away from the Operating state.

Day 10: By the tenth day, the probability of the machine Operating has almost halved to 0.42, while the probabilities of being Idle or needing Maintenance have nearly reached parity with the Operating state, at 0.13 and 0.45, respectively.

The trends observed in the output reflect the underlying transition matrix used in the Markov chain model, which dictates how the machine transitions between states. The model suggests that as time goes on, the likelihood of the machine requiring maintenance increases, which is expected in a real-world scenario as wear and tear take their toll.

For a maintenance team, such a model could inform decisions about when preventative maintenance might be most effectively scheduled to minimize downtime. For operations managers, it offers insights into the expected availability of machinery, which is crucial for planning production schedules.

## irrigation circles

```{r}
# Given rotation times data
rotation_times <- c(
  21.80086, 23.74087, 24.6675, 22.1376, 21.4186, 
  23.80423, 23.11184, 24.23174, 24.826, 21.44181,
  22.09314, 22.96205, 25.27362, 23.23669, 22.05037,
  21.8075, 22.5501, 24.55148, 23.21969, 24.36872,
  24.56083, 23.8828, 21.84536, 21.90287, 21.55993,
  22.91966, 22.74965, 24.86386, 21.56766, 24.81992,
  22.77892, 21.23745, 22.1006, 21.12459, 21.05793
)

# Step 2: Calculate the sample mean
mean_time <- mean(rotation_times)

# Step 3: Calculate the sample standard deviation
std_time <- sd(rotation_times)

# Step 4: Determine the t-critical value
n <- length(rotation_times)  # Sample size
alpha <- 0.10                # Significance level for 90% CI is 1 - 0.90
t_critical <- qt(1 - alpha/2, df = n - 1)

# Step 5: Calculate the standard error
standard_error <- std_time / sqrt(n)

# Step 6: Calculate the margin of error
margin_of_error <- t_critical * standard_error

# Step 7: Calculate the confidence interval
ci_lower <- mean_time - margin_of_error
ci_upper <- mean_time + margin_of_error

# Step 8: Output the results
list(
  mean = mean_time,
  standard_deviation = std_time,
  sample_size = n,
  t_critical = t_critical,
  standard_error = standard_error,
  margin_of_error = margin_of_error,
  confidence_interval = c(ci_lower, ci_upper)
)

```
After analyzing the operation of center pivot irrigation systems, which play a pivotal role in modern agriculture, we've deduced some key operational timings. Specifically, we've focused on the rotation period—the time it takes for the system's arm to fully circle around its central pivot point.

Our data indicates that the average complete rotation takes about 22.92 hours. However, day-to-day operations may vary slightly, as indicated by the standard deviation of 1.29 hours. This variability could be influenced by several factors including mechanical differences, field conditions, and specific irrigation needs.

We've also established a 90% confidence interval for this average rotation time, which is between 22.55 and 23.91 hours. This interval gives us a high level of certainty about the regularity of the irrigation process under typical conditions. The derived confidence interval is a statistically robust estimate that can aid in modeling and optimizing irrigation schedules, enhancing water conservation efforts, and potentially improving crop yields. It help farmers to predict irrigation cycle, ensuring that crops receive a steady supply of water and nutrients. It also means that energy usage, given the 1HP power requirement per tower, can be anticipated and managed effectively.

Overall, our analysis reinforces the center pivot system's reliability, offering a quantitative perspective that supports both operational efficiency and agricultural sustainability.
